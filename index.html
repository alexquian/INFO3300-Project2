<!DOCTYPE html>
<html>
<head>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://d3js.org/topojson.v2.min.js"></script>
</head>
<body>

<h1>INFO 3300 Project 2</h1>

<style>
</style>

<svg class="mapArea" height="500" width="1500" style="display: block; margin: 0 auto; background-color: lightsalmon"/>
<svg class="dataArea" height="150" width="1500" style="display: block; margin: 0 auto; margin-top: 10px; background-color: lightgrey"/>

<script>
  const map = d3.select(".mapArea");
  const mapH = map.attr("height");
  const mapW = map.attr("width");
  const margin = {top: 35, right: 35, bottom: 35, left: 35};

  const mapHeight = mapH - margin.right - margin.left;
  const mapWidth = mapW - margin.top - margin.bottom;

  // CREATE AREA FOR US MAP and TRANSLATE
  const usMap = map.append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
                    .attr("width", 620)
                    .attr("height", mapHeight)

  const usHeight = Number(usMap.attr("height"));
  const usWidth = Number(usMap.attr("width"));

  // CREATE AREA FOR MUSLIM BAN COUNTRIES AND TRANSLATE
  const muslimMap = map.append("g")
                        .attr("transform", "translate(" + (usWidth + margin.left + 20) + "," + margin.top + ")")
                        .attr("width", 620)
                        .attr("height", mapHeight);

  const visualizeData = async() => {

    // IMPORT TERROR DATASET
    const usAttacks = await d3.csv("../datasets/usTerrorism.csv");
    console.log(usAttacks);

    // IMPORT IMMIGRATION DATASET
    const immigration = await d3.csv("../datasets/muslimBanImmigration.csv");
    console.log(immigration);

    const usData = await d3.json("../datasets/us.json");
      let states = topojson.feature(usData, usData.objects.states);
      let project = d3.geoMercator().scale(750).center([-95.7129, 37.0902]).translate([margin.left + 330, margin.top + 200]);
      let path = d3.geoPath().projection(project);

      usMap.selectAll("path").data(states.features)
        .enter()
        .append("path")
        .attr("class", "state")
        .style("fill", "white")
        .style("stroke", "none")
        .attr("d", path)
        .attr("note", d => d.id);

      usMap.append("path")
        .datum(topojson.mesh(usData, usData.objects.states))
        .style("stroke", "black")
        .style("fill", "none")
        .attr("note", d=> d.id)
        .attr("d", path);

      // var data = [{longitude: -73.931351, latitude: 40.697132}];
      // console.log(data);
      //
      // var circles = usMap.selectAll("circle")
      //   .data(data)
      //   .enter()
      //   .append("circle")
      //   .attr("cx", function(data) { return project([data.longitude, data.latitude])[0]; })
      //   .attr("cy", function(data) { return project([data.longitude, data.latitude])[1]; })
      //   .attr("r", 4.5)
      //   .attr("fill", "red");
  }

  visualizeData();

</script>

</body>
</html>
